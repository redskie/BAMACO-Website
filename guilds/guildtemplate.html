<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Guild Template - BAMACO</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    
        <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="../assets/tailwind-config.js"></script>
    <script>tailwind.config = window.BAMACO_TAILWIND_CONFIG;</script>
    
    <!-- Keep original styles as fallback -->
    <link rel="stylesheet" href="../assets/styles.css" />
    
    <script>
      // ============================================
      // GUILD INFORMATION - EDIT THIS SECTION
      // ============================================
      const GUILD_INFO = {
        // Guild ID - IMPORTANT: Must match guild filename (e.g., 'dragon_warriors' for dragon_warriors.html)
        id: 'your_guild_id',

        // Basic Information
        name: 'Guild Name Here',
        motto: 'Your guild motto here',

        // Stats
        // NOTE: memberCount is AUTO-CALCULATED by generate_data.py based on player profiles
        // Do NOT manually set memberCount here - it will be overwritten!
        memberCount: '0',  // This will be auto-calculated
        level: '1',
        established: 'Month Year',

        // Description
        description:
          "Write a detailed description of your guild here. Include information about your guild's goals, culture, and what makes it unique.",

        // Image (Optional)
        guildLogo: '', // Add path to guild logo image (PNG/JPEG). Leave empty to use first letter

        // Achievements (Add as many as needed)
        achievements: [
          {
            icon: 'üèÜ',
            name: 'Achievement Name 1',
            description: 'Description of the achievement',
          },
          {
            icon: 'üë•',
            name: 'Achievement Name 2',
            description: 'Description of the achievement',
          },
          {
            icon: 'üíé',
            name: 'Achievement Name 3',
            description: 'Description of the achievement',
          },
        ],

        // NOTE: Members are automatically loaded from data.json based on players' guildId
        // No need to manually add members here!
      };
    </script>
  </head>
  <body class="bg-bg-primary text-text-primary font-sans antialiased overflow-x-hidden">
    <!-- Navbar will be dynamically generated by navbar.js -->

    <main class="max-w-screen-xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
      <div class="bg-bg-card border border-border-primary rounded-xl p-6 sm:p-8 mb-8 hover-btn-secondary hover:shadow-[0_10px_30px_rgba(0,0,0,0.3)]">
        <div class="flex flex-col sm:flex-row gap-6 items-center sm:items-start">
          <div class="w-32 h-32 rounded-full bg-bg-secondary border-4 border-border-primary flex items-center justify-center text-5xl font-bold text-text-primary overflow-hidden flex-shrink-0 transition-transform duration-300 hover:scale-105" id="guild-emblem">
            <span id="guild-letter"></span>
          </div>
          <div class="flex-1 text-center sm:text-left">
            <h2 class="text-3xl sm:text-4xl font-bold text-text-primary mb-2" id="guild-name"></h2>
            <p class="text-lg text-text-secondary mb-4" id="guild-motto"></p>
            <div class="grid grid-cols-3 gap-4">
              <div class="text-center">
                <span class="block text-sm text-text-muted mb-1">Members</span>
                <span class="block text-xl font-bold text-text-primary" id="guild-members"></span>
              </div>
              <div class="text-center">
                <span class="block text-sm text-text-muted mb-1">Level</span>
                <span class="block text-xl font-bold text-text-primary" id="guild-level"></span>
              </div>
              <div class="text-center">
                <span class="block text-sm text-text-muted mb-1">Established</span>
                <span class="block text-xl font-bold text-text-primary" id="guild-established"></span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="space-y-8">
        <section>
          <h3 class="text-2xl font-bold text-text-primary mb-4">About the Guild</h3>
          <div class="bg-bg-card border border-border-primary rounded-xl p-6 hover-btn-secondary hover:shadow-[0_10px_30px_rgba(0,0,0,0.3)]">
            <p class="text-text-secondary leading-relaxed" id="guild-description"></p>
          </div>
        </section>

        <section>
          <h3 class="text-2xl font-bold text-text-primary mb-4">Achievements</h3>
          <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4" id="guild-achievements"></div>
        </section>

        <section>
          <h3 class="text-2xl font-bold text-text-primary mb-4">Guild Members</h3>
          <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4" id="guild-members-list"></div>
        </section>
      </div>
    </main>

    <footer class="bg-bg-secondary border-t border-border-primary py-6 mt-12 bg-gradient-to-r from-bg-card to-bg-secondary shadow-lg">
      <div class="max-w-screen-xl mx-auto px-4 sm:px-6 lg:px-8 text-center text-text-muted">
        <p>&copy; 2026 BAMACO - Bataan MaiMai Community. All rights reserved.</p>
      </div>
    </footer>

    <script src="../assets/page-transitions.js"></script>
    <script src="../assets/script.js"></script>
    <script src="../assets/navbar.js"></script>
    <script>
      // Populate guild page with GUILD_INFO data
      document.addEventListener('DOMContentLoaded', async function () {
        // Update page title
        document.title = `${GUILD_INFO.name} - BAMACO`;

        // Basic information
        document.getElementById('guild-name').textContent = GUILD_INFO.name;
        document.getElementById('guild-motto').textContent = GUILD_INFO.motto;
        document.getElementById('guild-level').textContent = GUILD_INFO.level;
        document.getElementById('guild-established').textContent =
          GUILD_INFO.established;
        document.getElementById('guild-description').textContent =
          GUILD_INFO.description;

        // Guild logo
        const guildEmblem = document.getElementById('guild-emblem');
        const guildLetter = document.getElementById('guild-letter');

        if (GUILD_INFO.guildLogo && GUILD_INFO.guildLogo.trim() !== '') {
          guildEmblem.style.backgroundImage = `url('${GUILD_INFO.guildLogo}')`;
          guildEmblem.style.backgroundSize = 'cover';
          guildEmblem.style.backgroundPosition = 'center';
          guildLetter.style.display = 'none';
        } else {
          guildLetter.textContent = GUILD_INFO.name.charAt(0).toUpperCase();
        }

        // Achievements
        const achievementsContainer =
          document.getElementById('guild-achievements');
        GUILD_INFO.achievements.forEach((achievement) => {
          const achievementHTML = `
            <div class="bg-bg-card border border-border-primary rounded-xl p-4 text-center transition-all duration-300 hover-btn-secondary hover:shadow-[0_10px_20px_rgba(0,0,0,0.3)]">
              <div class="text-4xl mb-2">${achievement.icon}</div>
              <div class="font-bold text-text-primary mb-1">${achievement.name}</div>
              <div class="text-sm text-text-muted">${achievement.description}</div>
            </div>
          `;
          achievementsContainer.innerHTML += achievementHTML;
        });

        // Load members from data.json automatically
        try {
          const response = await fetch('../config/data.json');
          const data = await response.json();

          // Find this guild's data
          const guildData = data.guilds.find((g) => g.id === GUILD_INFO.id);

          if (guildData && guildData.members) {
            // Update member count with actual count from data.json
            document.getElementById('guild-members').textContent =
              guildData.members.length;

            // Populate members
            const membersContainer =
              document.getElementById('guild-members-list');
            guildData.members.forEach((member) => {
              // Use member.id for correct file linking
              const playerSlug = member.id.replace(/_/g, '-');
              const memberHTML = `
                <div class="bg-bg-card border border-border-primary rounded-xl p-6 cursor-pointer transition-all duration-300 hover-btn-secondary hover:shadow-[0_10px_20px_rgba(0,0,0,0.3)]" onclick="window.location.href='../players/${playerSlug}.html'">
                  <div class="w-16 h-16 rounded-full bg-bg-secondary flex items-center justify-center text-2xl font-bold text-text-primary mx-auto mb-4">${member.ign.charAt(0)}</div>
                  <h3 class="text-xl font-bold text-text-primary text-center mb-1">${member.ign}</h3>
                  <div class="text-text-secondary text-center text-sm mb-4" id="member-role-${member.id}"></div>
                  <div class="grid grid-cols-2 gap-2 pt-4 border-t border-border-primary">
                    <div class="text-center">
                      <span class="block text-lg font-bold text-text-primary">${member.rating}</span>
                      <span class="block text-xs text-text-muted">Rating</span>
                    </div>
                    <div class="text-center">
                      <span class="block text-lg font-bold text-text-primary">${member.rank}</span>
                      <span class="block text-xs text-text-muted">Rank</span>
                    </div>
                  </div>
                </div>
              `;
              membersContainer.innerHTML += memberHTML;
              
              // Apply marquee to role after HTML is added
              setTimeout(() => {
                const roleElement = document.getElementById(`member-role-${member.id}`);
                if (roleElement && typeof applyMarqueeToElement === 'function') {
                  applyMarqueeToElement(roleElement, member.role || member.title || 'Member', 25);
                }
              }, 0);
            });
          } else {
            // No members found
            document.getElementById('guild-members').textContent = '0';
            document.getElementById('guild-members-list').innerHTML =
              '<p class="text-center text-text-muted col-span-full">No members yet</p>';
          }
        } catch (error) {
          console.error('Error loading guild members:', error);
          document.getElementById('guild-members-list').innerHTML =
            '<p class="text-center text-text-muted col-span-full">Error loading members</p>';
        }
      });
    </script>
  </body>
</html>
